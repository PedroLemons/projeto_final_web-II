<div class="layout-container">
  <app-navbar class="sidenav"></app-navbar>

  <main class="content">
    <section class="container">
      <header>
        <h1 class="title">Relatório de Receita</h1>
        <p class="subtitle">Receita total da empresa, agrupada por categoria de equipamento.</p>
      </header>

      <div class="relatorio-content">
        <div class="actions-container">
          <button mat-raised-button color="primary" (click)="gerarPDF()" [disabled]="relatorioPorCategoria.length === 0">
            <mat-icon>picture_as_pdf</mat-icon>
            Gerar PDF
          </button>
        </div>

        <div class="relatorio-tabela">
          <div *ngIf="relatorioPorCategoria.length === 0" class="empty-state">
            <p>Nenhuma categoria com receita encontrada.</p>
          </div>

          <table mat-table [dataSource]="relatorioPorCategoria" class="mat-elevation-z4" *ngIf="relatorioPorCategoria.length > 0">

            <ng-container matColumnDef="categoria">
              <th mat-header-cell *matHeaderCellDef> Categoria </th>
              <td mat-cell *matCellDef="let item"> {{item.categoria}} </td>
              <td mat-footer-cell *matFooterCellDef> <strong>Total Geral</strong> </td>
            </ng-container>

            <ng-container matColumnDef="quantidadeServicos">
              <th mat-header-cell *matHeaderCellDef class="align-center"> Qtd. Serviços </th>
              <td mat-cell *matCellDef="let item" class="align-center"> {{item.quantidadeServicos}} </td>
              <td mat-footer-cell *matFooterCellDef></td>
            </ng-container>

            <ng-container matColumnDef="receitaTotal">
              <th mat-header-cell *matHeaderCellDef class="align-right"> Receita Total </th>
              <td mat-cell *matCellDef="let item" class="align-right"> {{item.receitaTotal | currency:'BRL'}} </td>
              <td mat-footer-cell *matFooterCellDef class="align-right"> <strong>{{totalCategoria | currency:'BRL'}}</strong> </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            <tr mat-footer-row *matFooterRowDef="displayedColumns" class="total-row"></tr>
          </table>
        </div>
      </div>
    </section>
  </main>
</div>